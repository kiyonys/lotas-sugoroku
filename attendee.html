<!doctype html><html lang="ja"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>æœ€å¼·çµŒå–¶ã‚¹ã‚´ãƒ­ã‚¯ï½œå‚åŠ è€…</title>
<link rel="stylesheet" href="assets/css/app.css"/>
</head>
<body data-page="attendee">
<div class="wrap">
  <div class="panel">
    <h2>å…¥å ´ãƒ•ã‚©ãƒ¼ãƒ </h2>
    <form id="entryForm">
      <label>ä¼šç¤¾åï¼ˆä¼šå ´ã«ã¯è¡¨ç¤ºã—ã¾ã›ã‚“ï¼‰</label>
      <input id="company" placeholder="ä¾‹ï¼šABCãƒ¢ãƒ“ãƒªãƒ†ã‚£" required/>
      <label>ãŠåå‰ï¼ˆä¼šå ´ã«ã¯è¡¨ç¤ºã—ã¾ã›ã‚“ï¼‰</label>
      <input id="name" placeholder="ä¾‹ï¼šå±±ç”°" required/>
      <label>å¾“æ¥­å“¡æ•°</label>
      <select id="size" required>
        <option value="">é¸æŠ</option>
        <option>1-4</option><option>5-9</option><option>10-19</option>
        <option>20-49</option><option>50-99</option><option>100+</option>
      </select>
      <div class="grid-2" style="margin-top:12px">
        <button class="btn accent" type="submit">å‚åŠ ã™ã‚‹</button>
        <button class="btn" type="button" id="saveCfgLite">Firebaseè¨­å®š</button>
      </div>
    </form>
<!-- é€ä¿¡å¾Œã®å®Œäº†è¡¨ç¤º -->
<div id="done" style="display:none; text-align:center; padding:24px 16px;">
  <h2 style="font-size:22px; margin:0 0 8px; letter-spacing:.02em;">
    ã‚¹ã‚´ãƒ­ã‚¯ã‚²ãƒ¼ãƒ ã¸ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼å®Œäº†ï¼
  </h2>
  <p style="margin:0; opacity:.9;">
    ç«¯æœ«ã‹ã‚‰æ‰‹ã‚’æ”¾ã—ã€ã‚¹ã‚¿ãƒ¼ãƒˆã™ã‚‹ã¾ã§ãŠå¾…ã¡ãã ã•ã„ã€‚
  </p>
</div>

    <p class="small" style="margin-top:10px">â€» å‚åŠ æƒ…å ±ã¯ä¼šå ´ç”»é¢ã«ä¼šç¤¾åãƒ»æ°åã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ï¼ˆå€‹ç¤¾ç‰¹å®šãªã—ï¼‰ã€‚</p>
  </div>
</div>
<script src="assets/js/app.js"></script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

  // ğŸ”¹ config.json ã‹ã‚‰è¨­å®šã‚’å–å¾—
  fetch('https://kiyonys.github.io/lotas-sugoroku/config.json')
    .then(response => response.json())
    .then(async config => {
      const app = initializeApp(config);
      const db = getFirestore(app);

      // ğŸ”¹ ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆ
      const form = document.getElementById('entryForm');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const company = form.company.value;
        const name = form.name.value;
        const size = form.size.value;
        const event = `event-${new Date().toISOString().slice(0,10)}`;
form.addEventListener('submit', async (e) => {
  e.preventDefault();

  const company = form.company.value;
  const name    = form.name.value;
  const size    = form.size.value;
  const event   = `event-${new Date().toISOString().slice(0,10)}`;

  // é€ä¿¡ãƒœã‚¿ãƒ³ã®ç„¡åŠ¹åŒ–ï¼ˆé€£æ‰“é˜²æ­¢ï¼‰
  const submitBtn = form.querySelector('button[type="submit"]');
  submitBtn.disabled = true;
  submitBtn.textContent = 'é€ä¿¡ä¸­â€¦';

  try {
    await addDoc(collection(db, 'attendees'), {
      company, name, size, event,
      timestamp: serverTimestamp()
    });

    // âœ… æˆåŠŸï¼šãƒ•ã‚©ãƒ¼ãƒ ã‚’éš ã—ã¦å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã ã‘è¡¨ç¤º
    form.style.display = 'none';
    const smallNote = document.querySelector('.small');
    if (smallNote) smallNote.style.display = 'none';

    const done = document.getElementById('done');
    done.style.display = 'block';
    window.scrollTo({ top: 0, behavior: 'smooth' }); // ä¸Šã«å¯„ã›ã¦è¦‹ã›ã‚„ã™ã
  } catch (err) {
    alert('âš ï¸ ç™»éŒ²ã‚¨ãƒ©ãƒ¼: ' + err.message);
    console.error(err);
    // å¤±æ•—æ™‚ã¯å…ƒã«æˆ»ã™
    submitBtn.disabled = false;
    submitBtn.textContent = 'å‚åŠ ã™ã‚‹';
  }
});

          })
    .catch(err => {
      console.error("config.json èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:", err);
    });
</script>
<script type="module">
  // 1) Firebase SDK (modular) ã‚’CDNã‹ã‚‰èª­ã¿è¾¼ã¿
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp } 
    from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

  // 2) å…¬é–‹ä¸­ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ï¼ˆGitHub Pages ä¸Šï¼‰
  const res = await fetch("https://kiyonys.github.io/lotas-sugoroku/config.json", { cache: "no-store" });
  if (!res.ok) throw new Error("config fetch failed: " + res.status);
  const firebaseConfig = await res.json();

  // 3) åˆæœŸåŒ–
  const app = initializeApp(firebaseConfig);
  const db  = getFirestore(app);

  // 4) ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ â†’ Firestore ã¸è¿½åŠ 
  const form = document.getElementById("entryForm");
  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const company = form.company.value.trim();
    const name    = form.name.value.trim();
    const size    = form.size.value;
    const event   = `event-${new Date().toISOString().slice(0,10)}`;

    try {
      await addDoc(collection(db, "attendees"), {
        company, name, size, event,
        timestamp: serverTimestamp()
      });
      alert("âœ… ç™»éŒ²ã—ã¾ã—ãŸï¼");
      form.reset();
    } catch (err) {
      console.error(err);
      alert("âš ï¸ ç™»éŒ²ã‚¨ãƒ©ãƒ¼: " + err.message);
    }
  });
</script>

</body></html>